# Aruco code recognition and transportation scenarios

## 1.Scene Construction

Use 3*3 long white baffles to build the venue and place them correctly according to the area in the picture

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-1.png)

The white baffle is mounted together with black connecting clips

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-2.png)

## 2.Loading and unloading table assembly

The installation method of the loading and unloading table is the same. Here are the installation instructions for the unloading table

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-3.png)

Take out a 280mm aluminum profile

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-4.png)

Insert a slider nut

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-5.png)

Rotate 90° backwards

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-6.png)

Install the two slider nuts

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-7.png)

Rotate back 90°

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-6.png)

Angle slot connectors on both sides

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-8.png)

Right-angle connectors on both sides

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-9.png)

Take out a 147.5mm aluminum profile and install two slider nuts inside

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-10.png)

Similarly, two slider nuts are installed on the right side and connected together through the right-angle connector.

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-11.png)

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-12.png)

Take out another 280mm aluminum profile, connect the angle slot connectors and right angle connectors on both sides, and connect them together

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-13.png)

The assembly effect is as follows

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-14.png)

Take out the screws and hex wrench, and fix the right-angle connectors around, a total of 16 screws

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-15.png)

Install four 110mm aluminum profiles

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-16.png)

The right-angle connectors around the perimeter are also fixed with screws, with a total of 8 screws
![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-17.png)

The same specification screws are used to fix the interior, a total of 8 screws are used

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-18.png)

Take out the last piece of 232mm aluminum profile and install two slider nuts and two angle slot connectors

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-19.png)

Angle slot connectors are inserted into the grooves of the aluminum profiles

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-20.png)

Turn the whole thing over and fix the connector with screws

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-21.png)

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-22.png)

Determine the positions of the five slider nuts and install the acrylic plate

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-23.png)

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-24.png)

Paste the Aruco code sticker onto the Aruco code printout, making sure not to paste it in the wrong direction

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-25.png)

Fasten the Aruco code printout with screws

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-26.png)

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-27.png)

Adjust the slider nut and fix the anti-collision block with screws

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-28.png)

Final effect after installation

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-29.png)

## 3.Composite robot assembly

Use an internal hexagon wrench to remove the four M4*8 internal hexagon screws of myAGV

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-30.png)

Use an Allen wrench to remove the two M2.5 Allen screws on myAGV.

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-31.png)

Install the myCobot280Pi robot arm with the X-axis in the correct direction and fix the 280Pi with four M4*8 screws.

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-32.png)

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-33.png)
 
Re-tighten the M4*8 and M2.5 hexagon socket screws

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-34.png)

Return each joint to zero (align with scale lines)

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-35.png)

The camera is plugged into the Lego building blocks

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-36.png)

Rotate the sixth joint 45° clockwise, align it with the hole, and install the camera horizontally.

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-37.png)

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-38.png)

Connect the camera's USB cable to the USB port on the 280Pi base.

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-45.png)

Integrated suction pump plugs into Lego building blocks

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-39.png)

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-40.png)

Wrap the suction pump Grove interface wire around and connect it to the io port at the end of the robot arm. Only connect two wires G23 and G33

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-41.png)

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-42.png)

Connect the power supply to the sixth joint of the robot arm and connect 5V and GND

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-43.png)

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-44.png)

Connect the robot power cable, one end to myAGV and the other end to the robot base

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-48.png)

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-49.png)

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-50.png)

Installing the Pallet

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-46.png)

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-47.png)

The touch screen is an optional product
The following are the screen assembly and installation instructions

Take out the IPS touch screen, hinge and matching screws from the accessory box, and fix the hinge with screws

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-51.png)

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-52.png)

Install the black connector, pay attention to the direction of the black connector, and install the fixing screws

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-53.png)

Tighten the screws into the three screw holes corresponding to the connector

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-54.png)

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-55.png)

Connect the HDMI cable and Micro USB2 to myAGV

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-56.png)

Final installation effect

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-87.png)

## 4.myCobot calibrates zero point

Connect the micro HDMI port of the myCobot280pi base to the display screen, and connect the USB port to the mouse and keyboard. Now the myCobot280pi screen is controlled by the display.

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-65.png)

After the connection is completed, the interface of the connected device is displayed on the desktop, as shown in the figure below.

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-88.png)

Double-click ROS1 Shell on the interface to open a console terminal and enter the following command in the command line:

```
cd mycobottesttool-221110/
```
```
python main.py
```

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-89.png)

After the command is entered, a pop-up window will appear. Select the corresponding device and baud rate, and then click Connect:
myCobot 280-Pi: 1000000

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-90.png)

After powering on, the joints of the robot arm are in a locked state. Click the calibration zero point, release the robot arm joint J1, manually return the robot arm J1 joint to zero position, click the calibration zero point again, release the robot arm joint J2, and so on until the calibration is completed to the J6 joint. The interface shows the calibration is completed, and the robot arm calibration is completed.

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-91.png)

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-92.png)

The calibration position of the sixth joint should be as shown in the figure below (keep the camera parallel to the ground and the calibration port offset by about 45°):

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-93.png)

## 5.Remote software use
### 5.1Download mobaXterm remote software

Enter the following [URL](https://mobaxterm.mobatek.net/) in the browser and download the remote connection software in advance on your computer

```
https://mobaxterm.mobatek.net/
```

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-57.png)

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-58.png)

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-59.png)

Just run the .exe file

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-60.png)


### 5.2Remote connection between myAGV and 280Pi

Press the power switch to turn on the myAGV

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-61.png)

Turn on myAGV's wifi hotspot: disconnect the currently connected wifi, then click the hotspot switch button. You need to turn it on manually for the first time, and the hotspot will automatically start when you turn on the device subsequently.

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-62.png)

After turning on the myAGV's wifi hotspot, you can see the name of myagv's hotspot in the upper right corner of the desktop: ElephantRobotics_AP_xxxx. Here, myAGV's hotspot is ElephantRobotics_AP_fdff.

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-64.png)

Select "Connection information" to view the current myAGV IP address: 10.42.0.1

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-63.png)

Then unplug the monitor cable of myAGV and connect the micro HDMI interface of myCobot280pi to the display. Now the screen of myCobot280pi is displayed.

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-65.png)

myCobot280pi connects to the wifi hotspot just generated by myAGV: Elephantrobotics_AP_fdff

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-66.png)

Select "Connection information" to view the current IP address of myCobot280Pi: 10.42.0.203

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-67.png)

The next operation requires a computer. Connect the computer to the myAGV wifi hotspot. Here, myAGV's hotspot is ElephantRobotics_AP_a317. Select the security key to connect, and then enter the hotspot password: Elephant

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-68.png)

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-69.png)

Use mobaXterm to connect to myAGV and click the Session icon

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-70.png)

Enter the car's IP: 10.42.0.1, click OK, and click Accept for the first connection.

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-71.png)

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-72.png)

Enter username: er
Enter password: Elephant
The password will not be displayed when you enter it. Enter it normally and press Enter to log in

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-73.png)

Normal login display screen

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-74.png)

Similarly, you can also log in to myCobot280 remotely. The IP address you use for logging in should be changed to the IP address you just queried: 10.42.0.203

## 6.Program running

Finally, make sure the composite robot is placed in the red frame position and started, and place the QR code wooden block on the workbench in the loading area. The placement of the QR code wooden block should be in the center of the robot arm camera scan, and the error of the center scan is small. Make sure no other terminal windows are opened.

A total of four programs need to be run, myAGV needs to run three terminals, myCobot280 needs to run one terminal

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-78.png)

### 6.1 myAGV turns on radar and underlying communication

Enter the following command in the first terminal

```
cd myagv_ros/src/myagv_odometry/scripts/
```

```
./start_ydlidar.sh
```

```
roslaunch myagv_odometry myagv_active.launch
```

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-75.png)

### 6.2 myAGV starts navigation function

1.Right click the IP address above, click Duplicate tab, and open the second terminal

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-76.png)

2.Similarly, you also need to log in with a username and password, which are er and Elephant respectively

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-77.png)

3.Enter the following command in the second terminal

```
roslaunch myagv_navigation composite_robot_navigation_active.launch
```

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-79.png)

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-80.png)

### 6.3 myAGV starts the socket server

1.Right click the IP address above, click Duplicate tab, and open the third terminal

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-76.png)

2.You also need to log in with a username and password, which are er and Elephant respectively.

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-77.png)

3.Enter the following command in the third terminal

```
cd ~/Composite-robot-kit/myagv-pi/
```

```
python agv_socket_server.py
```

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-81.png)

### 6.4 myCobot280 starts the socket client

1.Click the Session icon, and the login IP address should be changed to the IP address of myCobot280 just queried. The IP address queried here is 10.42.0.13

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-82.png)

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-83.png)

2.You also need to log in with a username and password, which are er and Elephant respectively.

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-84.png)

3.Enter the following command in the terminal

```
cd ~/Composite-robot-kit/myagv-pi/
```

```
python 280pi_socket_client.py
```

Click on the 4 terminals mode in Split to easily view the code running status

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-85.png)

In the myCobot robot arm IP: 10.42.0.13 terminal window prompt

```
connect finish
Enter any key and press enter
```

After pressing Enter or any key and waiting for the robot arm to send instructions, the whole process will proceed.

The composite robot will complete automatic navigation according to the instructions, and the robotic arm can accurately identify and grab the QR code building blocks process:

① myAGV fixed-point navigation
② myAGV QR code navigation
③ myCobot QR code recognition
④ myAGV fixed-point navigation
⑤ Robotic arm placement

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-86.png)

## 7.Precautions

Problem 1: During the suction process, the suction pump may not suck the center of the material.

Solution: Observe the scanning area of ​​the camera on the computer and place the material as close to the center of the camera as possible.

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-94.png)

Problem 2: There is a fixed error when the QR code recognition pump is sucked.

Solution: Observe the error of the X and Y axes, and increase or decrease the X and Y errors in line 85 of the 280pi_socket_client.py code.

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-95.png)

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-96.png)

Question 3: When the suction pump places the material into the trolley tray, the placement may be inaccurate, touching the edge of the tray and causing placement failure.

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-97.png)

Solution:
(1) Recalibrate the robot arm to zero position
(2) Calibrate the placement and removal of wooden blocks

The following is an introduction to calibrating the placement and removal of wooden blocks. First, use the remote software to connect to the robot arm through the IP address, then enter python in the terminal, press Enter to enter the command line mode, and enter the following command

```python
from pymycobot import MyCobot
mc = MyCobot('/dev/ttyAMA0',1000000)
mc.release_all_servos()
```

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-98.png)

Aim the suction pump at the center of the QR code

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-99.png)

Then enter the following command in the Python command line

```python
mc.power_on
coords=mc.get_coords()
coords[2]+=58
mc.send_coords(coords,20)
mc.get_angles()
```

Then it will return the current joint angle

```
[-51.85, 20.39, -116.45, -2.81, 7.38, 26.01]
```

Modify this joint angle to the 280pi_socket_client.py code

![](../../resources/7-ExamplesRobotsUsing/7.1/7.1.2/7.1.2-100.png)